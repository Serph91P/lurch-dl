<!DOCTYPE html>
<html>
<head>
    <title>Lurch-DL Web Interface</title>
    <link rel="stylesheet" type="text/css" href="/static/styles.css">
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            var ws = new WebSocket("ws://" + window.location.host + "/ws");
    
            ws.onmessage = function(event) {
                var message = JSON.parse(event.data);
    
                if (message.type === "title") {
                    document.getElementById("title").textContent = "Titel: " + message.title;
                } else if (message.type === "format") {
                    document.getElementById("format").textContent = "Format: " + message.format;
                } else if (message.type === "progress") {
                    var progressPercent = (message.progress * 100).toFixed(2); // Fortschritt in Prozent
                    var rate = (message.rate / 1000000).toFixed(2) + " MB/s"; // Download-Geschwindigkeit in MB/s

                    document.getElementById("progress-bar").style.width = progressPercent + "%";
                    document.getElementById("progress-text").textContent = progressPercent + "%";
                    document.getElementById("download-rate").textContent = "Download-Rate: " + rate + (extraInfo ? ", " + extraInfo : "");
                

                } else if (message.type === "error") {
                    document.getElementById("error").textContent = "Fehler: " + message.message;
                }
            };
    
            document.getElementById("start-download").onclick = function() {
                var url = document.getElementById("url").value;
                ws.send(JSON.stringify({ action: "start", url: url }));
                document.getElementById("stop-download").disabled = false;  // Button aktivieren
            };
    
            document.getElementById("stop-download").onclick = function() {
                ws.send(JSON.stringify({ action: "stop" }));
                this.disabled = true; // Deaktiviert den Stop-Download-Button
    
                // Setze die Inhalte der Elemente zur√ºck
                document.getElementById("title").textContent = "";
                document.getElementById("format").textContent = "";
                document.getElementById("progress").textContent = "";
                document.getElementById("error").textContent = "";
                document.getElementById("output").textContent = "";
            };
        });
    </script>       
</head>
<body>
    <header>
        <h1>Lurch-DL Web Interface</h1>
    </header>
    <div class="container">
        <input type="text" id="url" placeholder="URL eingeben">
        <button id="start-download">Download starten</button>
        <button id="stop-download" disabled>Download stoppen</button>
        <div id="title"></div>
        <div id="format"></div>
        <div id="progress-container" style="width: 80%; background-color: #ddd; margin: 0 auto;">
            <div id="progress-bar" style="width: 0%; height: 20px; background-color: #4CAF50; color: white; text-align: center;">
                <span id="progress-text"></span>
            </div>
        </div>
        <div id="download-rate"></div>              
        <div id="error"></div>
    </div>
</body>
</html>
